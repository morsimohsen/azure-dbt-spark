{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-21T18:48:31.717355Z", "invocation_id": "f9418746-dcf7-4c9f-8efb-e6ac2ffe2984", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T18:48:16.951604Z", "completed_at": "2025-05-21T18:48:17.056943Z"}, {"name": "execute", "started_at": "2025-05-21T18:48:17.056943Z", "completed_at": "2025-05-21T18:48:25.805231Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.866523504257202, "adapter_response": {"_message": "OK", "query_id": "c4e06f1a-48af-4ee4-a144-0c93dcbe9a73"}, "message": "OK", "failures": null, "unique_id": "model.azure_dbt_spark.dim_customer", "compiled": true, "compiled_code": "\n\nwith address_snapshot as (\n    select\n        AddressID,\n        AddressLine1,\n        AddressLine2,\n        City,\n        StateProvince,\n        CountryRegion,\n        PostalCode\n    from `hive_metastore`.`snapshots`.`address_snapshot` where dbt_valid_to is null\n)\n\n, customeraddress_snapshot as (\n    select\n        CustomerId,\n        AddressId,\n        AddressType\n    from `hive_metastore`.`snapshots`.`customeraddress_snapshot` where dbt_valid_to is null\n)\n\n, customer_snapshot as (\n    select\n        CustomerId,\n        concat(ifnull(FirstName,' '),' ',ifnull(MiddleName,' '),' ',ifnull(LastName,' ')) as FullName\n    from `hive_metastore`.`snapshots`.`customer_snapshot` where dbt_valid_to is null\n)\n\n, transformed as (\n    select\n    row_number() over (order by customer_snapshot.customerid) as customer_sk, -- auto-incremental surrogate key\n    customer_snapshot.CustomerId,\n    customer_snapshot.fullname,\n    customeraddress_snapshot.AddressID,\n    customeraddress_snapshot.AddressType,\n    address_snapshot.AddressLine1,\n    address_snapshot.City,\n    address_snapshot.StateProvince,\n    address_snapshot.CountryRegion,\n    address_snapshot.PostalCode\n    from customer_snapshot\n    inner join customeraddress_snapshot on customer_snapshot.CustomerId = customeraddress_snapshot.CustomerId\n    inner join address_snapshot on customeraddress_snapshot.AddressID = address_snapshot.AddressID\n)\nselect *\nfrom transformed", "relation_name": "`hive_metastore`.`saleslt`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T18:48:16.938708Z", "completed_at": "2025-05-21T18:48:17.040057Z"}, {"name": "execute", "started_at": "2025-05-21T18:48:17.040057Z", "completed_at": "2025-05-21T18:48:27.247400Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 10.30869197845459, "adapter_response": {"_message": "OK", "query_id": "291e5e37-658b-4ec1-90b5-090d6791fd4f"}, "message": "OK", "failures": null, "unique_id": "model.azure_dbt_spark.dim_product", "compiled": true, "compiled_code": "\n\nwith product_snapshot as (\n    select\n        productId,\n        name,\n        standardCost,\n        listPrice,\n        size,\n        weight,\n        productcategoryid,\n        productmodelid,\n        sellstartdate,\n        sellenddate,\n        discontinueddate\n    from `hive_metastore`.`snapshots`.`product_snapshot`\n    where dbt_valid_to is null\n),\n\nproduct_model_snapshot as (\n    select\n        productmodelid,\n        name,\n        CatalogDescription,\n        row_number() over (order by name) as model_id\n    from `hive_metastore`.`snapshots`.`productmodel_snapshot`\n    where dbt_valid_to is null\n),\n\n\ntransformed as (\n    select\n        row_number() over (order by p.productId) as product_sk,\n        p.name as product_name,\n        p.standardCost,\n        p.listPrice,\n        p.size,\n        p.weight,\n        pm.name as model,\n        pm.CatalogDescription as description,\n        p.sellstartdate,\n        p.sellenddate,\n        p.discontinueddate\n    from product_snapshot p\n    left join product_model_snapshot pm on p.productmodelid = pm.productmodelid\n)\n\nselect * from transformed", "relation_name": "`hive_metastore`.`saleslt`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-21T18:48:25.807241Z", "completed_at": "2025-05-21T18:48:25.807241Z"}, {"name": "execute", "started_at": "2025-05-21T18:48:25.807241Z", "completed_at": "2025-05-21T18:48:30.704942Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.897700309753418, "adapter_response": {"_message": "OK", "query_id": "2b875ffb-aec7-4c0e-b5d7-a9e9eac44164"}, "message": "OK", "failures": null, "unique_id": "model.azure_dbt_spark.sales", "compiled": true, "compiled_code": "\n\nwith salesorderdetail_snapshot as (\n    SELECT\n        SalesOrderID,\n        SalesOrderDetailID,\n        OrderQty,\n        ProductID,\n        UnitPrice,\n        UnitPriceDiscount,\n        LineTotal\n    FROM `hive_metastore`.`snapshots`.`salesorderdetail_snapshot`\n),\n\nproduct_snapshot as (\n    SELECT\n        ProductID,\n        Name,\n        ProductNumber,\n        Color,\n        StandardCost,\n        ListPrice,\n        Size,\n        Weight,\n        SellStartDate,\n        SellEndDate,\n        DiscontinuedDate,\n        ThumbNailPhoto,\n        ThumbnailPhotoFileName\n    FROM `hive_metastore`.`saleslt`.`product`\n),\n\nsaleorderheader_snapshot as (\n    SELECT\n        SalesOrderID,\n        RevisionNumber,\n        OrderDate,\n        DueDate,\n        ShipDate,\n        Status,\n        OnlineOrderFlag,\n        SalesOrderNumber,\n        PurchaseOrderNumber,\n        AccountNumber,\n        CustomerID,\n        ShipToAddressID,\n        BillToAddressID,\n        ShipMethod,\n        CreditCardApprovalCode,\n        SubTotal,\n        TaxAmt,\n        Freight,\n        TotalDue,\n        Comment,\n        row_number() over (partition by SalesOrderID order by SalesOrderID) as row_num\n    FROM `hive_metastore`.`saleslt`.`salesorderheader`\n),\n\ntransformed as (\n    select\n        sod.SalesOrderID,\n        sod.SalesOrderDetailID,\n        sod.OrderQty,\n        sod.ProductID,\n        sod.UnitPrice,\n        sod.UnitPriceDiscount,\n        sod.LineTotal,\n        p.Name,\n        p.ProductNumber,\n        p.Color,\n        p.StandardCost,\n        p.ListPrice,\n        p.Size,\n        p.Weight,\n        p.SellStartDate,\n        p.SellEndDate,\n        p.DiscontinuedDate,\n        p.ThumbNailPhoto,\n        p.ThumbnailPhotoFileName,\n        soh.RevisionNumber,\n        soh.OrderDate,\n        soh.DueDate,\n        soh.ShipDate,\n        soh.Status,\n        soh.OnlineOrderFlag,\n        soh.SalesOrderNumber,\n        soh.PurchaseOrderNumber,\n        soh.AccountNumber,\n        soh.CustomerID,\n        soh.ShipToAddressID,\n        soh.BillToAddressID,\n        soh.ShipMethod,\n        soh.CreditCardApprovalCode,\n        soh.SubTotal,\n        soh.TaxAmt,\n        soh.Freight,\n        soh.TotalDue,\n        soh.Comment\n    from salesorderdetail_snapshot sod\n    left join product_snapshot p on sod.ProductID = p.ProductID\n    left join saleorderheader_snapshot soh on sod.SalesOrderID = soh.SalesOrderID\n)\n\nselect * from transformed", "relation_name": "`hive_metastore`.`saleslt`.`sales`", "batch_results": null}], "elapsed_time": 18.57437753677368, "args": {"version_check": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "macro_debugging": false, "profiles_dir": "C:\\Users\\morsi\\.dbt", "favor_state": false, "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": false, "exclude": [], "log_format": "default", "partial_parse_file_diff": true, "defer": false, "print": true, "send_anonymous_usage_stats": true, "log_level_file": "debug", "use_colors_file": true, "quiet": false, "write_json": true, "static_parser": true, "log_file_max_bytes": 10485760, "invocation_command": "dbt run", "populate_cache": true, "log_path": "H:\\Acadmy\\My\\Projects\\Azure_Spark_DBT\\azure_dbt_spark\\logs", "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "strict_mode": false, "vars": {}, "empty": false, "project_dir": "H:\\Acadmy\\My\\Projects\\Azure_Spark_DBT\\azure_dbt_spark", "select": [], "require_resource_names_without_spaces": false, "log_level": "info", "which": "run", "log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "cache_selected_only": false, "introspect": true}}